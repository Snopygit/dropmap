<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Fortnite Dropmap</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #1a1a1a;
      color: white;
    }
    #tab-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .dropmap-entry {
      background: #2a2a2a;
      padding: 10px;
      margin: 10px;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .dropmap-entry img {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid #444;
    }
    .dropmap-entry button {
      margin-top: 8px;
      padding: 5px 10px;
      background: #444;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
    }
    #new-map-btn {
      margin-bottom: 20px;
      padding: 10px 20px;
      font-size: 16px;
      background: #333;
      border-radius: 8px;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="tab-container">
    <button id="new-map-btn" onclick="createNewDropmap()">âž• Neue Dropmap</button>
    <div id="dropmap-list"></div>
  </div>

  <script>
    let dropmaps = JSON.parse(localStorage.getItem('dropmaps') || '[]');

    function renderDropmapList() {
      const list = document.getElementById('dropmap-list');
      list.innerHTML = '';
      dropmaps.forEach((map, i) => {
        const div = document.createElement('div');
        div.className = 'dropmap-entry';

        const img = document.createElement('img');
        img.src = map.preview || 'fortnite-dropmap/assets/map.png';
        div.appendChild(img);

        const label = document.createElement('div');
        label.textContent = map.name;
        div.appendChild(label);

        const editBtn = document.createElement('button');
        editBtn.textContent = 'âœï¸ Bearbeiten';
        editBtn.onclick = () => {
          localStorage.setItem('editingDropmapIndex', i);
          window.location.href = 'editor.html';
        };
        div.appendChild(editBtn);

        const calcBtn = document.createElement('button');
        calcBtn.textContent = 'ðŸŽ¯ Calculate Drop';
        calcBtn.onclick = () => {
          localStorage.setItem('activeDropmap', JSON.stringify(map));
          window.location.href = 'calculate.html';
        };
        div.appendChild(calcBtn);

        const deleteBtn = document.createElement('button');
        deleteBtn.textContent = 'ðŸ—‘ï¸ LÃ¶schen';
        deleteBtn.onclick = () => {
          if (confirm('Diese Dropmap wirklich lÃ¶schen?')) {
            dropmaps.splice(i, 1);
            localStorage.setItem('dropmaps', JSON.stringify(dropmaps));
            renderDropmapList();
          }
        };
        div.appendChild(deleteBtn);

        list.appendChild(div);
      });
    }

    function createNewDropmap() {
      const name = prompt("Name der Dropmap:");
      if (!name) return;
      const newMap = {
        name,
        points: [],
        preview: 'fortnite-dropmap/assets/map.png'
      };
      dropmaps.push(newMap);
      localStorage.setItem('dropmaps', JSON.stringify(dropmaps));
      localStorage.setItem('editingDropmapIndex', dropmaps.length - 1);
      window.location.href = 'editor.html';
    }

    renderDropmapList();
  </script>
</body>
</html>
